<mat-card class="no-form">
  <div class="d-flex">
    <div class="left">
      <h2>ğŸ§¾ Final Summary</h2>

      <mat-divider />
      <h3>ğŸ“‰ Deductions Summary</h3>
      <table class="summary-table">
        <tr>
          <td>ğŸ“¦ 80C (PPF + LIC + PF)</td>
          <td>â‚¹{{ deductions.total80C | number }}</td>
        </tr>
        <tr>
          <td>ğŸ¥ 80D (Health Insurance)</td>
          <td>â‚¹{{ deductions.total80D | number }}</td>
        </tr>
        <tr>
          <td>ğŸ¦ 80CCD(1B) (NPS)</td>
          <td>â‚¹{{ deductions.npsDeduction | number }}</td>
        </tr>
        <tr>
          <td>ğŸ¡ Home Loan Interest (24b)</td>
          <td>â‚¹{{ deductions.housePropertySetoff | number }}</td>
        </tr>
        <tr>
          <td>ğŸ“ Education Loan (80E)</td>
          <td>â‚¹{{ data.educationLoanInterest | number }}</td>
        </tr>
        <tr>
          <td>ğŸ™ Donations (80G)</td>
          <td>â‚¹{{ data.donations80G | number }}</td>
        </tr>
        <tr>
          <td>ğŸ’° Savings Interest (80TTA)</td>
          <td>â‚¹{{ data.savingsInterest | number }}</td>
        </tr>
        <tr>
          <td>ğŸ  Rent (no HRA) (80GG)</td>
          <td>â‚¹{{ data.noHraRentPaid | number }}</td>
        </tr>
        <tr *ngIf="data.disabilityClaimType === 'self'">
          <td>â™¿ 80U (Self Disability)</td>
          <td>â‚¹{{ getDisabilityDeduction() | number }}</td>
        </tr>
        <tr *ngIf="data.disabilityClaimType === 'dependent'">
          <td>ğŸ§‘â€ğŸ¦½ 80DD (Dependent Disability)</td>
          <td>â‚¹{{ getDisabilityDeduction() | number }}</td>
        </tr>
        <tr>
          <td>ğŸ§¬ Critical Illness (80DDB)</td>
          <td>â‚¹{{ data.section80ddb | number }}</td>
        </tr>
        <tr>
          <td>ğŸš˜ EV Loan (80EEB)</td>
          <td>â‚¹{{ data.section80eeb | number }}</td>
        </tr>        
        <tr>
          <td><strong>ğŸ§® Total Deductible</strong></td>
          <td>
            <strong>â‚¹{{ deductions.totalDeductions | number }}</strong>
          </td>
        </tr>
      </table>

      <mat-divider />
      <h3>ğŸ’¼ Income & Rent</h3>
      <table class="summary-table">
        <tr>
          <td>ğŸ’µ Gross Salary</td>
          <td>â‚¹{{ data.salary | number }}</td>
        </tr>
        <tr>
          <td>ğŸ“Š Basic %</td>
          <td>{{ data.basicPercentage }}%</td>
        </tr>
        <tr>
          <td>ğŸ  HRA Received</td>
          <td>â‚¹{{ data.hra | number }}</td>
        </tr>
        <tr>
          <td>ğŸ™ï¸ Rent Paid</td>
          <td>
            â‚¹{{ data.rentPaid | number }} ({{
              data.isMetro ? "Metro" : "Non-Metro"
            }})
          </td>
        </tr>
      </table>

      <mat-divider />
      <h3 *ngIf="data.spouseSupport">ğŸ‘©â€â¤ï¸â€ğŸ‘¨ Spouse Support</h3>
      <table class="summary-table" *ngIf="data.spouseSupport">
        <tr>
          <td>Spouse Income</td>
          <td>â‚¹{{ data.spouseIncome | number }}</td>
        </tr>
        <tr>
          <td>Joint Home Loan Interest</td>
          <td>â‚¹{{ data.jointHomeLoanInterest | number }}</td>
        </tr>
      </table>

      <mat-divider />
      <h3>ğŸ’¼ Investments</h3>
      <table class="summary-table">
        <tr>
          <td>ğŸ›ï¸ PPF</td>
          <td>â‚¹{{ data.ppf | number }}</td>
        </tr>
        <tr>
          <td>ğŸ“„ LIC</td>
          <td>â‚¹{{ data.lic | number }}</td>
        </tr>
        <tr>
          <td>ğŸ¢ PF</td>
          <td>â‚¹{{ data.pf | number }}</td>
        </tr>
        <tr>
          <td>ğŸ“ˆ NPS</td>
          <td>â‚¹{{ data.nps | number }}</td>
        </tr>
      </table>

      <mat-divider />
      <h3>ğŸ¥ Health Insurance</h3>
      <table class="summary-table">
        <tr>
          <td>ğŸ§‘ Self</td>
          <td>â‚¹{{ data.healthInsuranceSelf | number }}</td>
        </tr>
        <tr>
          <td>ğŸ‘´ Parents</td>
          <td>â‚¹{{ data.healthInsuranceParents | number }}</td>
        </tr>
      </table>

      <mat-divider />
      <h3>ğŸ¡ Home Loan</h3>
      <table class="summary-table">
        <tr>
          <td>ğŸ“… Interest Claimed (This FY)</td>
          <td>â‚¹{{ data.homeLoanInterest | number }}</td>
        </tr>
      </table>

      <mat-divider />
      <h3>ğŸ± Food Card</h3>
      <table class="summary-table">
        <tr>
          <td>ğŸ’³ Total Received</td>
          <td>â‚¹{{ data.foodCard | number }}</td>
        </tr>
        <tr>
          <td>ğŸ§¾ Taxable Portion</td>
          <td>â‚¹{{ taxableFoodCard | number }}</td>
        </tr>
      </table>
    </div>

    <div class="right">
      <mat-divider />
      <h3>ğŸ§  Deduction Visualization</h3>
      <div style="max-width: 400px; margin: auto">
        <canvas baseChart [data]="pieChartData" [type]="pieChartType"></canvas>
      </div>

      <mat-divider />
      <h4 class="highlight">
        ğŸ’° Old Regime: â‚¹{{ oldTax | number }} | ğŸ§¾ New Regime: â‚¹{{
          newTax | number
        }}
      </h4>
      <h4 class="highlight" style="color: green">
        âœ… You should choose: {{ better.toUpperCase() }} REGIME
      </h4>
      <div class="d-col">
        <div class="btn-row">
          <button
            mat-raised-button
            color="primary"
            (click)="downloadPDF()"
            matTooltip="Download PDF"
          >
            â¬‡ï¸
          </button>
          <button
            mat-stroked-button
            (click)="copySummaryLink()"
            matTooltip="Share Summary"
          >
            ğŸ”—
          </button>
          <button
            mat-stroked-button
            (click)="exportAsXLSX()"
            matTooltip="Export Tax Sheet"
          >
            ğŸ“
          </button>
          <button
            mat-stroked-button
            color="warn"
            (click)="startOver()"
            matTooltip="Start Over"
          >
            ğŸ”„
          </button>
        </div>
        <app-suggestions-footer
          [data]="data"
          [deductions]="deductions"
          [taxableFoodCard]="taxableFoodCard"
          [oldTax]="oldTax"
          [newTax]="newTax"
        ></app-suggestions-footer>
        <app-audit-risk-tips
          [data]="data"
          [deductions]="deductions"
        ></app-audit-risk-tips>
      </div>
    </div>
  </div>
</mat-card>
